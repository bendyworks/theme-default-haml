= render :partial => 'admin/shared/configuration_menu'
= render :partial => "js_head"
%h1= t("taxonomy_edit")
%p#ajax_error.errorExplanation{:style => "display:none;"}
- form_for(:taxon, :url => admin_taxonomy_url, :html => { :method => :put }) do |f|
  = render :partial => 'form', :locals => {:f => f}
  %div
    %label= t("tree")
    %br/
    #taxonomy_tree.tree
  %p#progress{:style => "display:none;"}
    %img{:alt => "Spinner", :src => "/images/spinner.gif?1234540747", :style => "vertical-align:bottom;"}/
    = t('updating')
    \..
  %p
    %br/
    %small= t("taxonomy_tree_instruction")
  %p.form-buttons
    = button t("update")
    = t("or")
    = link_to t("cancel"), admin_taxonomies_path
- content_for :head do
  :javascript
    var initial = [
	   	{ attributes : 
	   	  { "id" : "#{@taxonomy.root.id}" }, 
			data : "#{@taxonomy.root.name}",
			state : "open",
			children : [
<haml:silent>				 @taxonomy.root.children.each_with_index do |taxon,i| 
</haml:silent><haml:block>					{
						attributes :
						{ id : "#{taxon.id}"},
						data : "#{taxon.name}"
<haml:silent>						 unless taxon.children.empty? 
</haml:silent><haml:block>							,state : "closed"
</haml:block>					}#{"," if i < (@taxonomy.root.children.size - 1)}
</haml:block>			]
      	}
    ];
    
  